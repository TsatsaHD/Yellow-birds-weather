<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>DHL Aviation - METAR & TAF</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #fff8dc;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #ffcc00;
      color: #ba0c2f;
      padding: 1em;
      text-align: center;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    header img {
      max-height: 50px;
      vertical-align: middle;
    }
    h1 {
      display: inline;
      font-size: 1.8em;
      margin-left: 0.5em;
      vertical-align: middle;
    }
    .search-container {
      text-align: center;
      margin: 1em 0;
    }
    input[type="text"] {
      padding: 0.5em;
      width: 250px;
      border: 2px solid #ba0c2f;
      border-radius: 5px;
    }
    button {
      background-color: #ba0c2f;
      color: white;
      border: none;
      padding: 0.5em 1em;
      margin-left: 0.5em;
      border-radius: 5px;
      cursor: pointer;
    }
    .station {
      background-color: #fff;
      margin: 1em auto;
      max-width: 800px;
      border: 2px solid #ba0c2f;
      border-radius: 10px;
      padding: 1em;
      box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
    }
    pre {
      background: #fff0c9;
      padding: 1em;
      overflow-x: auto;
      border-left: 4px solid #ba0c2f;
    }
    .loading {
      color: gray;
    }
  </style>
</head>
<body>
  <header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/20/DHL_Logo.svg/2560px-DHL_Logo.svg.png" alt="DHL Logo">
    <h1>DHL Aviation - Weerinfo</h1>
  </header>

  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Geef ICAO of IATA code in (bv. EBBR of BRU)">
    <button onclick="searchWeather()">Zoek</button>
  </div>

  <div id="searchResult"></div>

  <hr style="margin: 2em auto; width: 80%; border-color: #ba0c2f;">

  <div id="stations"></div>

  <script>
    const stationIds = [
      "Bordeaux",    // LFBD
      "Brussel",     // EBBR
      "Cincinnati",  // KCVG
      "East-Midlands", // EGNX
      "Kopenhagen",  // EKCH
      "Leipzig",     // EDDP
      "London Luton",// EGGW
      "Lyon",        // LFLL
      "Toulouse"     // LFBO
    ];

    const icaoMap = {
      "Bordeaux": "LFBD",
      "Brussel": "EBBR",
      "Cincinnati": "KCVG",
      "East-Midlands": "EGNX",
      "Kopenhagen": "EKCH",
      "Leipzig": "EDDP",
      "London Luton": "EGGW",
      "Lyon": "LFLL",
      "Toulouse": "LFBO"
    };

    function fetchMetarTaf(icao, containerIdPrefix) {
      // METAR
      fetch(`https://aviationweather.gov/api/data/metar?ids=${icao}&format=decoded`)
        .then(res => res.json())
        .then(data => {
          const content = data.length ? JSON.stringify(data[0], null, 2) : "Geen data beschikbaar.";
          document.getElementById(`${containerIdPrefix}-metar`).textContent = content;
        })
        .catch(() => {
          document.getElementById(`${containerIdPrefix}-metar`).textContent = "Fout bij ophalen METAR.";
        });

      // TAF
      fetch(`https://aviationweather.gov/api/data/taf?ids=${icao}&format=decoded`)
        .then(res => res.json())
        .then(data => {
          const content = data.length ? JSON.stringify(data[0], null, 2) : "Geen data beschikbaar.";
          document.getElementById(`${containerIdPrefix}-taf`).textContent = content;
        })
        .catch(() => {
          document.getElementById(`${containerIdPrefix}-taf`).textContent = "Fout bij ophalen TAF.";
        });
    }

    function renderStation(name, icao, container) {
      const div = document.createElement("div");
      div.className = "station";
      div.innerHTML = `<h2>${name} (${icao})</h2>
        <p><strong>METAR:</strong></p>
        <pre id="${icao}-metar" class="loading">Laden...</pre>
        <p><strong>TAF:</strong></p>
        <pre id="${icao}-taf" class="loading">Laden...</pre>`;
      container.appendChild(div);
      fetchMetarTaf(icao, icao);
    }

    // Toon standaardstations
    const stationContainer = document.getElementById("stations");
    stationIds.sort().forEach(name => {
      const icao = icaoMap[name];
      renderStation(name, icao, stationContainer);
    });

    // Zoekfunctie
    function searchWeather() {
      const code = document.getElementById("searchInput").value.trim().toUpperCase();
      const resultContainer = document.getElementById("searchResult");
      resultContainer.innerHTML = "";

      if (!code || code.length < 3) {
        alert("Voer een geldige ICAO of IATA code in (minimaal 3 tekens).");
        return;
      }

      const div = document.createElement("div");
      div.className = "station";
      div.innerHTML = `<h2>Zoekresultaat voor ${code}</h2>
        <p><strong>METAR:</strong></p>
        <pre id="zoek-${code}-metar" class="loading">Laden...</pre>
        <p><strong>TAF:</strong></p>
        <pre id="zoek-${code}-taf" class="loading">Laden...</pre>`;
      resultContainer.appendChild(div);
      fetchMetarTaf(code, `zoek-${code}`);
    }
  </script>
</body>
</html>