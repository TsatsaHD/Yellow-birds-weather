<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DHL Aviation Weer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #fffbe6;
      color: #8B0000;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #FFD700;
      padding: 20px;
      text-align: center;
      border-bottom: 5px solid #D2042D;
    }

    header h1 {
      margin: 0;
      color: #8B0000;
    }

    .search-container {
      display: flex;
      justify-content: center;
      padding: 20px;
      background-color: #fff4cc;
    }

    .search-container input {
      width: 400px;
      padding: 10px;
      font-size: 16px;
      border: 2px solid #D2042D;
      border-radius: 5px;
    }

    .stations, .search-results {
  padding: 20px;
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* Max 2 kolommen */
  gap: 20px; /* Vergroot de afstand tussen de kolommen */
  justify-content: center;
  max-width: 100%; /* Zorgt ervoor dat het scherm niet breder is dan 100% */
}

.stations {
  max-width: calc(100% - 40px); /* Zorgt voor een marge van 20px aan beide zijden */
  margin: 0 auto; /* Centreert de grid */
}

.station {
  background-color: #fff;
  border: 2px solid #D2042D;
  border-radius: 10px;
  padding: 15px;
  width: 100%; /* Zorgt ervoor dat de stations zich aanpassen aan de kolommen */
  box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
}

@media (max-width: 768px) {
  .stations {
    grid-template-columns: 1fr; /* 1 kolom op kleinere schermen */
    gap: 20px;
  }

  .search-container input {
    width: 90%;
  }
}

  </style>
</head>
<body>
  <header>
    <h1>DHL Aviation – Weerinfo</h1>
  </header>

  <div class="search-container">
    <input type="text" id="searchInput" placeholder="Zoek op IATA, ICAO of naam (bv. BRU, LFPG, Linz)" />
  </div>

  <div id="searchResult" class="search-results"></div>

  <h2 style="text-align: center;">Alle DHL-stations</h2>
  <div id="stations" class="stations"></div>

  <script>
    const stations = [
      { name: "Bahrein",            icao: "OBBI", iata: "BAH" },
      { name: "Barcelona",          icao: "LEBL", iata: "BCN" },
      { name: "Basel",              icao: "LFSB", iata: "BSL" },
      { name: "Bologna",            icao: "LIPE", iata: "BLQ" },
      { name: "Bordeaux",           icao: "LFBD", iata: "BOD" },
      { name: "Brussel",            icao: "EBBR", iata: "BRU" },
      { name: "Budapest",           icao: "LHBP", iata: "BUD" },
      { name: "Casablanca",         icao: "GMMN", iata: "CMN" },
      { name: "Cincinnati",         icao: "KCVG", iata: "CVG" },
      { name: "Dublin",             icao: "EIDW", iata: "DUB" },
      { name: "East-Midlands",      icao: "EGNX", iata: "EMA" },
      { name: "Hongkong",           icao: "VHHH", iata: "HKG" },
      { name: "Keulen",             icao: "EDDK", iata: "CGN" },
      { name: "Kopenhagen",         icao: "EKCH", iata: "CPH" },
      { name: "Lagos",              icao: "DNMM", iata: "LOS" },
      { name: "Leipzig",            icao: "EDDP", iata: "LEJ" },
      { name: "Linz",               icao: "LOWL", iata: "LNZ" },
      { name: "London Luton",       icao: "EGGW", iata: "LTN" },
      { name: "Lyon",               icao: "LFLL", iata: "LYS" },
      { name: "Madrid",             icao: "LEMD", iata: "MAD" },
      { name: "Malpensa",           icao: "LIMC", iata: "MXP" },
      { name: "Marseille",          icao: "LFML", iata: "MRS" },
      { name: "Mulhouse",           icao: "LFSB", iata: "MLH" },
      { name: "Parijs Charles de Gaulle", icao: "LFPG", iata: "CDG" },
      { name: "Porto",              icao: "LPPR", iata: "OPO" },
      { name: "Riyad",              icao: "OERK", iata: "RUH" },
      { name: "Shanghai",           icao: "ZSPD", iata: "PVG" },
      { name: "Shenzhen",           icao: "ZGSZ", iata: "SZX" },
      { name: "Toulouse",           icao: "LFBO", iata: "TLS" },
      { name: "Vitoria",            icao: "LEVT", iata: "VIT" }
    ];

    function fetchViaProxy(url) {
      const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
      return fetch(proxyUrl).then(response => {
        if (!response.ok) throw new Error("Netwerkfout");
        return response.text();
      });
    }

    function fetchMetarTaf(icao, containerIdPrefix) {
      fetchViaProxy(`https://aviationweather.gov/cgi-bin/data/metar.php?ids=${icao}&format=decoded`)
        .then(data => {
          document.getElementById(`${containerIdPrefix}-metar`).textContent = data || "Geen METAR beschikbaar.";
        })
        .catch(() => {
          document.getElementById(`${containerIdPrefix}-metar`).textContent = "Fout bij ophalen METAR.";
        });

      fetchViaProxy(`https://aviationweather.gov/cgi-bin/data/taf.php?ids=${icao}&format=decoded`)
        .then(data => {
          document.getElementById(`${containerIdPrefix}-taf`).textContent = data || "Geen TAF beschikbaar.";
        })
        .catch(() => {
          document.getElementById(`${containerIdPrefix}-taf`).textContent = "Fout bij ophalen TAF.";
        });
    }

    function renderStation(title, icao, containerIdPrefix, container) {
      const div = document.createElement("div");
      div.className = "station";
      div.innerHTML = `<h2>${title}</h2>
        <p><strong>METAR:</strong></p>
        <pre id="${containerIdPrefix}-metar" class="loading">Laden...</pre>
        <p><strong>TAF:</strong></p>
        <pre id="${containerIdPrefix}-taf" class="loading">Laden...</pre>`;
      container.appendChild(div);
      fetchMetarTaf(icao, containerIdPrefix);
    }

    function searchWeather() {
      const input = document.getElementById("searchInput").value.trim();
      const resultContainer = document.getElementById("searchResult");
      resultContainer.innerHTML = "";

      if (!input) {
        alert("Geef minstens één zoekterm in.");
        return;
      }

      const terms = input.split(",").map(t => t.trim().toUpperCase());

      terms.forEach(term => {
        if (!term) return;

        let match = stations.find(s =>
          s.icao.toUpperCase() === term || s.iata.toUpperCase() === term || s.name.toUpperCase() === term
        );

        if (!match && term.length === 4) {
          match = { name: "Onbekend station", icao: term, iata: "?" };
        }

        if (match) {
          const idPrefix = `zoek-${match.icao}`;
          renderStation(`${match.name} (${match.iata})`, match.icao, idPrefix, resultContainer);
        } else {
          const div = document.createElement("div");
          div.className = "station";
          div.innerHTML = `<h2>Station niet gevonden: ${term}</h2>`;
          resultContainer.appendChild(div);
        }
      });
    }

    document.getElementById("searchInput").addEventListener("keydown", function(e) {
      if (e.key === "Enter") {
        e.preventDefault();
        searchWeather();
      }
    });

    const stationContainer = document.getElementById("stations");
    stations.sort((a, b) => a.name.localeCompare(b.name)).forEach(station => {
      renderStation(`${station.name} (${station.iata})`, station.icao, station.icao + "-" + station.iata, stationContainer);
    });
  </script>
</body>
</html>